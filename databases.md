# Базы данных

- [Индексы](#индексы)
- [Что почитать/посмотреть](#что-почитатьпосмотреть)

## Индексы

![](static/indexes.png)

При создании индекса в базе данных фактически создается отдельная таблица с информацией о том, по какому индексу стоит искать определенные значения.

Когда создавать индексы?

- индексы следует создавать по мере обнаружения медленных запросов - запросы, которые выполняются более 1 секунды, являются первыми кандидатами на оптимизацию
- начинайте создание индексов с самых частых запросов - запрос, выполняющийся секунду, но 1000 раз в день наносит больше ущерба, чем 10-секундный запрос, который выполняется несколько раз в день
- не создавайте индексы на таблицах, число записей в которых меньше нескольких тысяч - для таких размеров выигрыш от использования индекса будет почти незаметен
- не создавайте индексы заранее - индексы должны устанавливаться исключительно под форму и тип нагрузки работающей системы
- удаляйте неиспользуемые индексы

## Кластеризация

В postgres нет такого понятия, как кластеризованный индекс. Также postgres не выполняет кластеризацию самостоятельно, автоматически. В postgres есть возможность выполнить кластеризацию таблицы по индексу с помощью команды CLUSTER. Сразу после выполнения этой команды таблицу можно назвать кластеризованной.

Кластеризация - это физическое упорядочивание данных на диске.

> Кластерный индекс — это древовидная структура данных, при которой значения индекса хранятся вместе с данными, им соответствующими. И индексы, и данные при такой организации упорядочены. При добавлении новой строки в таблицу, она дописывается не в конец файла*, не в конец плоского списка, а в нужную ветку древовидной структуры, соответствующую ей по сортировке. Один из самых мощных и производительных движков для MySQL — InnoDB. Тому много причин, и одна из них — кластерные индексы. Проще всего понять как устроены кластерные индексы, если представить их в динамике: как они разрастаются по мере добавления данных, и как начинает ветвиться таблица.

> Механизм хранения InnoDB. Это один из самых популярных и широко используемых механизмов хранения данных в экосистеме MySQL. InnoDB поддерживает блокировку на уровне строки, улучшая параллелизм для смешанных рабочих нагрузок.

## Что почитать/посмотреть

- [Индексы в MySQL](https://highload.today/indeksy-v-mysql)
